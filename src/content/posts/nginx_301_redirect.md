---
title: ðŸ”§ Nginx 301 é‡å®šå‘æš´éœ²ç«¯å£å·é—®é¢˜è§£å†³æ–¹æ¡ˆ
published: 2025-12-06
updated: 2025-12-06
description: 'Nginx 301 é‡å®šå‘æš´éœ²ç«¯å£å·é—®é¢˜è§£å†³æ–¹æ¡ˆ'
image: '/images/nginx_301_redirect.png'
tags: [nginx]
category: 'è¿ç»´'
draft: false
---
# ðŸ”§ Nginx 301 é‡å®šå‘æš´éœ²ç«¯å£å·é—®é¢˜è§£å†³æ–¹æ¡ˆ

> ðŸ’¡ **é—®é¢˜æè¿°:** å½“å®¢æˆ·ç«¯é€šè¿‡ API ç½‘å…³æˆ–åå‘ä»£ç†è®¿é—®åŽç«¯ Nginx æœåŠ¡æ—¶ï¼ŒNginx åœ¨å¤„ç†ç›®å½•è®¿é—®ï¼ˆç¼ºå°‘å°¾éƒ¨æ–œæ ï¼‰æ—¶ä¼šè‡ªåŠ¨è¿”å›ž 301 é‡å®šå‘ã€‚é‡å®šå‘çš„ Location å¤´å¯èƒ½ä¼šæš´éœ² Nginx çš„å†…éƒ¨ç«¯å£å·ï¼Œå¯¼è‡´å®¢æˆ·ç«¯è¯·æ±‚å¤±è´¥ã€‚
>
> **æ ¸å¿ƒè§£å†³æ–¹æ¡ˆ**æ˜¯åœ¨ Nginx çš„ `server` å—ä¸­é…ç½® `absolute_redirect off;`ï¼Œç¦ç”¨ç»å¯¹è·¯å¾„é‡å®šå‘ã€‚

---

## é—®é¢˜åœºæ™¯

å…¸åž‹çš„é—®é¢˜åœºæ™¯å¦‚ä¸‹ï¼š

- å®¢æˆ·ç«¯é€šè¿‡ **API ç½‘å…³**ï¼ˆå¦‚ `https://blog.gmai.top`ï¼Œç›‘å¬ 443 ç«¯å£ï¼‰è®¿é—®åŽç«¯æœåŠ¡
- åŽç«¯ Nginx ç›‘å¬åœ¨**å†…éƒ¨ç«¯å£**ï¼ˆå¦‚ 8080ã€50001 ç­‰ï¼‰
- å½“è®¿é—®çš„è·¯å¾„æ˜¯**ç›®å½•**ä¸”ç¼ºå°‘å°¾éƒ¨æ–œæ æ—¶ï¼ˆå¦‚ `/hd-portal`ï¼‰ï¼ŒNginx ä¼šè‡ªåŠ¨è¿”å›ž 301 é‡å®šå‘åˆ° `/hd-portal/`
- **é—®é¢˜ï¼š** é‡å®šå‘çš„ Location å¤´æš´éœ²äº† Nginx çš„å†…éƒ¨ç«¯å£å·ï¼Œå¦‚ `https://blog.gmai.top:50001/hd-portal/`
- å¯¼è‡´å®¢æˆ·ç«¯æ— æ³•æ­£ç¡®è®¿é—®ï¼Œè¯·æ±‚é“¾æ–­è£‚

---

## åŽŸå› åˆ†æž

Nginx åœ¨é‡åˆ°ç›®å½•è®¿é—®æ—¶ï¼Œä¼šæ ¹æ®ä»¥ä¸‹é…ç½®å‚æ•°ç”Ÿæˆ 301 é‡å®šå‘å“åº”ï¼š

- **`absolute_redirect`**ï¼šæ˜¯å¦å¯ç”¨ç»å¯¹è·¯å¾„é‡å®šå‘ï¼ˆé»˜è®¤ `on`ï¼‰
- **`server_name_in_redirect`**ï¼šé‡å®šå‘ä¸­æ˜¯å¦ä½¿ç”¨ `server_name`ï¼ˆé»˜è®¤ `off`ï¼‰
- **`port_in_redirect`**ï¼šé‡å®šå‘ä¸­æ˜¯å¦åŒ…å«ç«¯å£å·ï¼ˆé»˜è®¤ `on`ï¼‰

å½“ `absolute_redirect` ä¸º `on` æ—¶ï¼ŒNginx ä¼šç”ŸæˆåŒ…å«å®Œæ•´ URL çš„ Location å¤´ï¼Œå¯èƒ½ä¼šåŒ…å«å†…éƒ¨ç«¯å£å·ï¼Œä»Žè€Œæš´éœ²ç»™å®¢æˆ·ç«¯ã€‚

---

## è§£å†³æ–¹æ¡ˆï¼šé…ç½® absolute_redirect off

åœ¨ Nginx çš„ `server` å—ä¸­æ·»åŠ  `absolute_redirect off;` é…ç½®ï¼Œç¦ç”¨ç»å¯¹è·¯å¾„é‡å®šå‘ã€‚

### é…ç½®ç¤ºä¾‹

```nginx
server {
    listen 8080;
    server_name blog.gmai.top;

    # ç¦ç”¨ç»å¯¹è·¯å¾„é‡å®šå‘
    absolute_redirect off;

    location / {
        root /var/www/html;
        index index.html index.htm;
    }

    location /hd-portal {
        alias /var/www/hd-portal;
        index index.html;
    }
}
```

### é…ç½®è¯´æ˜Ž

- **`absolute_redirect off;`**ï¼šç¦ç”¨ç»å¯¹è·¯å¾„é‡å®šå‘ï¼ŒNginx å°†è¿”å›žç›¸å¯¹è·¯å¾„çš„ Location å¤´ï¼ˆå¦‚ `/hd-portal/`ï¼‰ï¼Œè€Œä¸æ˜¯å®Œæ•´çš„ URLï¼ˆå¦‚ `https://blog.gmai.top:50001/hd-portal/`ï¼‰
- é…ç½®åº”æ”¾ç½®åœ¨ **`server` å—**ä¸­ï¼Œå¯¹æ•´ä¸ªè™šæ‹Ÿä¸»æœºç”Ÿæ•ˆ
- å¦‚æžœåªéœ€è¦å¯¹ç‰¹å®š `location` ç”Ÿæ•ˆï¼Œä¹Ÿå¯ä»¥æ”¾ç½®åœ¨ `location` å—ä¸­

---

## é‡æ–°åŠ è½½ Nginx é…ç½®

ä¿®æ”¹é…ç½®åŽï¼Œé‡æ–°åŠ è½½ Nginx ä½¿é…ç½®ç”Ÿæ•ˆï¼š

```bash
# æµ‹è¯•é…ç½®æ–‡ä»¶è¯­æ³•
sudo nginx -t

# é‡æ–°åŠ è½½é…ç½®
sudo nginx -s reload
# æˆ–
sudo systemctl reload nginx
```

---

## éªŒè¯æ•ˆæžœ

ä½¿ç”¨ `curl` å‘½ä»¤éªŒè¯é‡å®šå‘è¡Œä¸ºï¼š

```bash
# è®¿é—®ç›®å½•ï¼ˆç¼ºå°‘å°¾éƒ¨æ–œæ ï¼‰
curl -I https://blog.gmai.top/hd-portal

# é¢„æœŸå“åº”ï¼ˆé…ç½®å‰ï¼‰
HTTP/1.1 301 Moved Permanently
Location: https://blog.gmai.top:50001/hd-portal/

# é¢„æœŸå“åº”ï¼ˆé…ç½®åŽï¼‰
HTTP/1.1 301 Moved Permanently
Location: /hd-portal/
```

é…ç½®åŽï¼ŒLocation å¤´å˜ä¸ºç›¸å¯¹è·¯å¾„ï¼Œä¸å†æš´éœ²å†…éƒ¨ç«¯å£å·ã€‚

---

## æ€»ç»“

é€šè¿‡åœ¨ Nginx çš„ `server` å—ä¸­é…ç½® `absolute_redirect off;`ï¼Œå¯ä»¥æœ‰æ•ˆè§£å†³ 301 é‡å®šå‘æš´éœ²å†…éƒ¨ç«¯å£å·çš„é—®é¢˜ï¼Œç¡®ä¿å®¢æˆ·ç«¯è¯·æ±‚æ­£å¸¸è½¬å‘ï¼Œé¿å…æš´éœ²æœåŠ¡å™¨å†…éƒ¨æž¶æž„ä¿¡æ¯ã€‚

> âœ… **å…³é”®é…ç½®ï¼š**
> ```nginx
> server {
>     server_name blog.gmai.top;
>     absolute_redirect off;
> }
> ```